# base borrowed from https://stackoverflow.com/a/1080019
debug ?= 0
ifeq ($(debug), 0)
    CFLAGS =-std=c++20 -Wall -pedantic -O2
else
    CFLAGS=-std=c++20 -Wall -pedantic -Werror -D_GLIBCXX_DEBUG -fsanitize=address -fsanitize=undefined -g -Og
endif

# base borrowed from presentation slides
CXX=g++
LD=g++
OBJS= test.o CellPosition.o Expression.o Spreadsheet.o AST.o

all: acme_program
acme_program: $(OBJS)
	$(LD) -o $@ $^ -L/parser/x86_64-darwin23-g++/
clean:
	rm -f acme_program $(OBJS)
%.o: %.cpp
	$(CXX) $(CFLAGS) -c $<

# generated by g++ -MM
AST.o: src/AST.cpp src/../include/AST.hpp
CellPosition.o: src/CellPosition.cpp src/../include/CellPosition.hpp
Expression.o: src/Expression.cpp src/../include/Expression.hpp \
 src/../include/../parser/expression.h src/../include/CellPosition.hpp \
 src/../include/AST.hpp
Spreadsheet.o: src/Spreadsheet.cpp src/../include/Spreadsheet.hpp \
 src/../include/CellPosition.hpp src/../include/CellPosition.hpp \
 src/../include/Expression.hpp src/../include/../parser/expression.h \
 src/../include/AST.hpp

